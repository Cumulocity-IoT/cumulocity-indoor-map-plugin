<div class="action-container" style="
  display: flex; 
  align-items: end; 
  gap: 15px; 
  margin-bottom: 15px; 
  flex-wrap: wrap;
">
  <!-- Floor Level - Fixed width -->
  <div style="min-width: 140px; flex-shrink: 0;">
    <label for="floorLevelSelect" class="c8y-label">Floor Level</label>
    <div class="c8y-select-wrapper">
      <select
        id="floorLevelSelect"
        class="form-control"
        [(ngModel)]="currentFloorLevel"
        (ngModelChange)="onLevelChanged()"
      >
        <option
          *ngFor="let level of building?.levels; let i = index"
          value="{{ i }}"
          title="{{ level.name }}"
        >
          {{ level.name }}
        </option>
      </select>
    </div>
  </div>

  <!-- Search - Flexible, takes most space -->
  <div style="flex: 1; min-width: 250px;">
    <label class="c8y-label">Search Devices</label>
    <div class="input-group input-group-search">
      <input
        class="form-control"
        type="search"
        placeholder="Search devices by Name, Type, or IDâ€¦"
        [(ngModel)]="searchString"
        (ngModelChange)="filterMarkers()"
        aria-label="Search input"
      />
      <span class="input-group-btn">
        <button
          class="btn btn-clean"
          type="button"
          title="Search"
          aria-label="Search"
          *ngIf="!searchString || searchString.length === 0"
        >
          <i c8yIcon="search"></i>
        </button>
        <button
          class="btn btn-clean"
          type="button"
          title="Clear search"
          aria-label="Clear search"
          *ngIf="searchString && searchString.length > 0"
          (click)="searchString = ''; filterMarkers()"
        >
          <i c8yIcon="times"></i>
        </button>
      </span>
    </div>
  </div>

  <!-- Device Type - Fixed width -->
  <div style="min-width: 140px; flex-shrink: 0;">
    <label for="deviceTypeSelect" class="c8y-label">Device Type</label>
    <div class="c8y-select-wrapper">
      <select
        id="deviceTypeSelect"
        class="form-control"
        [(ngModel)]="selectedType"
        (ngModelChange)="filterMarkers()"
        title="Filter by device type"
      >
        <option value="">All Types</option>
        <option
          *ngFor="let type of uniqueDeviceTypes"
          value="{{ type }}"
          title="{{ type }}"
        >
          {{ type }}
        </option>
      </select>
    </div>
  </div>

  <!-- Show Zones - Auto width -->
  <div style="min-width: 100px;">
    <label class="c8y-label">Zones</label>
    <div style="height: 34px; display: flex; align-items: center;">
      <label
        class="c8y-switch"
        title="Switch on/off"
        aria-label="Show Zones toggle switch"
        style="margin: 0;"
      >
        <input
          type="checkbox"
          [(ngModel)]="showZones"
          (ngModelChange)="toggleZoneVisibility()"
        />
        <span></span>
      </label>
    </div>
  </div>

  <!-- Share Button - Minimal width -->
  <div style="min-width: 50px;">
    <label class="c8y-label">Share</label>
    <button
      class="btn btn-default"
      (click)="onShareConfiguration()"
      title="Share current view configuration"
      style="
        width: 34px;
        height: 34px;
        padding: 0;
        display: flex;
        align-items: center;
        justify-content: center;
      "
    >
      <i c8yIcon="share" style="font-size: 16px; color: #333;"></i>
    </button>
  </div>

  <!-- Refresh - Auto width -->
  <div style="min-width: 80px;">
    <label class="c8y-label">Refresh</label>
    <div style="height: 34px; display: flex; align-items: center;">
      <interval-refresh
        [isLoading$]="isLoading$"
        [isIntervalToggleEnabled]="true"
        (onCountdownEnded)="refresh()"
      >
      </interval-refresh>
    </div>
  </div>
</div>

<div class="content-scroll-container">
  <div class="map-container" style="height: 70%; padding: 10px">
    <c8y-loading
      class="loading-absolute"
      *ngIf="isLoading$ | async"
    ></c8y-loading>
    <div class="map-frame" style="width: 100%; height: 100%">
      <div
        #IndoorDataPointMap
        style="width: 100%; height: 100%; background-color: #fff"
      ></div>
    </div>
  </div>

  <map-data-grid
    [devices]="filteredDevicesForGrid"
    (rowClicked)="highlightRow($event)"
  ></map-data-grid>
</div>

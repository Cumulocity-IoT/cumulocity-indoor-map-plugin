<div class="widget-config-container">
  <div class="input-group m-b-24">
    <c8y-form-group class="m-b-16">
      <label for="mapConfigSelect">Building Selection</label>

      <input
        id="mapConfigSelect"
        [(ngModel)]="mapConfigInput"
        [typeahead]="mapConfigurations"
        typeaheadOptionField="name"
        (typeaheadOnSelect)="onMapConfigurationSelected($event)"
        (ngModelChange)="onMapConfigurationInputChange($event)"
        placeholder="Start typing to select or create new"
        class="form-control"
      />

      <small class="text-muted"
        >Select an existing configuration or type a new name to create
        one.</small
      >
    </c8y-form-group>

    <div
      *ngIf="showCreateOption"
      class="create-map-config-btn input-group-btn m-t-24"
    >
      <button
        type="button"
        class="btn btn-primary btn-block"
        (click)="createNewMapConfiguration()"
      >
        <i c8yIcon="plus-circle" class="c8y-icon"></i>
        Create "<strong>{{ mapConfigInput }}</strong
        >"
      </button>
    </div>

    <div class="input-group-btn m-t-24" *ngIf="selectedMapConfigurationId">
      <button
        type="button"
        class="btn btn-dot text-danger"
        title="Delete configuration"
        aria-label="Delete configuration"
        (click)="onDeleteMapConfiguration()"
      >
        <i c8yIcon="trash" class="c8y-icon"></i>
      </button>
    </div>
  </div>

  <hr />

  <div *ngIf="selectedBuilding">
    <div class="legend form-block">Building Configuration</div>

    <c8y-form-group>
      <label>Floor Configuration</label>
      <p class="small">
        Draw a rectangle on the map to define the image bounds.
      </p>
      <button
        type="button"
        class="btn btn-default btn-block"
        (click)="openFloorConfigurationModal()"
      >
        <i c8yIcon="devices" class="c8y-icon"></i> Configure Floors
        <span *ngIf="hasFloorConfiguration()" class="text-success pull-right">
          <i c8yIcon="check-circle"></i>
        </span>
      </button>
    </c8y-form-group>

    <c8y-form-group>
      <label>Building Boundaries</label>
      <p class="small">
        Draw a rectangle on the map to define the image bounds.
      </p>
      <button
        type="button"
        class="btn btn-default btn-block"
        (click)="openMapBoundaryModal()"
      >
        <i c8yIcon="devices" class="c8y-icon"></i> Draw Map Boundaries
        <span *ngIf="hasBuildingBoundaries()" class="text-success pull-right">
          <i c8yIcon="check-circle"></i>
        </span>
      </button>
    </c8y-form-group>

    <c8y-form-group>
      <label>Set Floor Zones</label>
      <p class="small">Define zones for the floor plan</p>
      <button
        type="button"
        class="btn btn-default btn-block"
        (click)="onZoneCreation()"
      >
        <i c8yIcon="map-editing" class="c8y-icon"></i>Manage Zones and
        Boundaries
      </button>
    </c8y-form-group>
    <c8y-form-group>
      <label>Associate Devices to floor</label>
      <p class="small">Link physical devices to this map's levels.</p>
      <button
        type="button"
        class="btn btn-default btn-block"
        (click)="openAssignDevicesModal()"
      >
        <i c8yIcon="devices" class="c8y-icon"></i> Assign Devices to Floors
      </button>
    </c8y-form-group>

    <c8y-form-group>
      <label>Edit Device Locations</label>
      <p class="small">
        Select a device and set its exact position on the map image.
      </p>
      <button
        type="button"
        class="btn btn-default btn-block"
        (click)="onEditDeviceLocation()"
      >
        <i c8yIcon="map-marker" class="c8y-icon"></i> Edit Device Location
      </button>
    </c8y-form-group>

    <c8y-form-group>
      <label>Configure Data Grid Columns</label>
      <p class="small">
        Customize which columns appear in the data grid and their order.
      </p>
      <button
        type="button"
        class="btn btn-default btn-block"
        (click)="openColumnConfigModal()"
      >
        <i c8yIcon="table" class="c8y-icon"></i> Configure Columns
        <span *ngIf="config && config.columnConfig && config.columnConfig.length > 0" class="text-success pull-right" [title]="(config.columnConfig?.length || 0) + ' columns configured'">
          <i c8yIcon="check-circle"></i>
        </span>
      </button>
    </c8y-form-group>

    <!--  <c8y-form-group>
      <label>Configure Marker</label>
      <p class="small">
        Configure the appearance and behavior of device markers on the map.
      </p>
      <button
        type="button"
        class="btn btn-default btn-block"
        (click)="onEditDeviceLocation()"
      >
        <i c8yIcon="map-marker" class="c8y-icon"></i> Edit Device Location
      </button>
    </c8y-form-group> -->
  </div>
</div>
